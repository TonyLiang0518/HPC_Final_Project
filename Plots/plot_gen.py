import numpy as np
import matplotlib.pyplot as plt

N = 2**np.arange(1,17)
recursion_seq  = "2.1234500000000003962e-06 3.7447999999999992808e-06 7.0703999999999975608e-06 1.752560000000000039e-05 3.7780750000000005843e-05 8.5291200000000007655e-05 0.00018637400000000002858 0.00040999440000000003312 0.00089964064999999994975 0.0019619848500000000233 0.0042363620000000004606 0.0090604712499999986303 0.019315103199999999334 0.040998073099999997326 0.087022246950000020638 0.18525902965000001776"
recursion_par  = "8.8515000000000011416e-07 2.6420500000000003945e-06 6.3562000000000002314e-06 1.5370099999999997057e-05 3.6206649999999996638e-05 8.2205149999999986609e-05 0.00018298249999999999845 0.00040688580000000006088 0.00089195360000000000443 0.0019489381000000003535 0.006840686599999999673 0.011527895450000000613 0.021528137149999997807 0.042578516599999997883 0.087906690500000023158 0.18233290000000001996"
recursion_task = "0.0015307564499999998069 0.0012086439500000002376 0.0012271406500000002666 0.0012076555999999999576 0.0012114931999999999698 0.0012173139000000001222 0.0012671960500000001813 0.0012668447000000000648 0.00147219490000000011 0.0022780184499999996464 0.0026965899000000004108 0.0036507145000000003864 0.0061054353000000007382 0.010026139499999999621 0.019711291550000002715 0.038045621299999998755"
iteration_seq  = "7.877000000000000985e-07 2.688500000000000602e-06 3.3392000000000001487e-06 4.5442000000000013171e-06 6.3239500000000006672e-06 9.6768500000000003629e-06 1.726875000000000301e-05 3.3085199999999999614e-05 8.5617100000000024304e-05 0.00020990145000000003995 0.00057416075000000003047 0.0014308277500000000058 0.0036989040000000002542 0.0092559119000000002198 0.022950810600000003114 0.055466071099999993133"
iteration_par  = "1.030450000000000019e-06 2.0266000000000006374e-06 2.7721999999999999023e-06 3.8873999999999994063e-06 5.6311500000000011339e-06 9.0491500000000012736e-06 1.6237099999999997396e-05 3.1808549999999995498e-05 8.542515000000002693e-05 0.0002080718499999999855 0.00057165665000000003525 0.0014270144500000000402 0.0037759016999999997152 0.0093918477999999985806 0.022896144100000005023 0.055250949350000001792"
fftw = "3.8860299999999997904e-05 1.0046950000000000428e-05 1.0055450000000002125e-05 1.1743650000000000632e-05 1.3702450000000002952e-05 2.8175100000000007441e-05 3.2173599999999999736e-05 3.8633800000000009475e-05 6.23683000000000039e-05 9.6647700000000006412e-05 0.00019661589999999998213 0.00038906800000000006353 0.0012050558500000000881 0.0030252105500000003695 0.0062614925000000019178 0.014789753999999998707"



recursion_soln  = "0.84147098480789650488 0.84081955671952579578 0.83885953606476770794 0.83557385454940125147 0.83093453326769983747 0.82490338035181154375 0.81743295798410309239 0.808467808533567589 0.79794592593244073608 0.78580045431799816491 0.77196159142664555475 0.75635866929433193118 0.73892237959533890734 0.71958710560147731705 0.69829331747725864599 0.67498998269859655785 0.64963693908006248101 0.62220717452337082065 0.59268895546259259266 0.56108774536529504307 0.52742785579951256825 0.49175377568020062213 0.45413112947326927937 0.41464722237401735461 0.37341113969868378053 0.33055337873188961328 0.2862250037497903743 0.24059632848024997687 0.19385514437535292243 0.14620452720520940582 0.097860268049354340314 0.049047987175588947384 -5.6752697146293868079e-17 -0.049047987175589127795 -0.09786026804935449297 -0.14620452720520937806 -0.19385514437535295018 -0.24059632848025006013 -0.28622500374979042981 -0.3305533787318896688 -0.37341113969868383604 -0.41464722237401746563 -0.45413112947326944591 -0.49175377568020067764 -0.52742785579951245722 -0.56108774536529493204 -0.59268895546259259266 -0.62220717452337082065 -0.64963693908006248101 -0.67498998269859666888 -0.69829331747725864599 -0.71958710560147720603 -0.73892237959533890734 -0.75635866929433193118 -0.77196159142664566577 -0.78580045431799816491 -0.79794592593244084711 -0.80846780853356770002 -0.81743295798410320341 -0.82490338035181143272 -0.83093453326769994849 -0.83557385454940125147 -0.83885953606476770794 -0.84081955671952579578 -0.84147098480789650488 -0.84081955671952579578 -0.83885953606476770794 -0.83557385454940125147 -0.83093453326769983747 -0.82490338035181154375 -0.81743295798410309239 -0.808467808533567589 -0.79794592593244073608 -0.78580045431799816491 -0.77196159142664555475 -0.75635866929433193118 -0.73892237959533890734 -0.71958710560147731705 -0.69829331747725864599 -0.67498998269859655785 -0.64963693908006248101 -0.62220717452337082065 -0.59268895546259259266 -0.56108774536529504307 -0.52742785579951256825 -0.49175377568020073316 -0.4541311294732693904 -0.41464722237401746563 -0.37341113969868389155 -0.33055337873188972431 -0.28622500374979048532 -0.24059632848025008789 -0.19385514437535303345 -0.14620452720520951684 -0.097860268049354451336 -0.049047987175589058406 -5.6752697146293868079e-17 0.049047987175589016773 0.097860268049354381947 0.14620452720520926704 0.19385514437535283916 0.24059632848024994911 0.28622500374979031879 0.33055337873188955777 0.37341113969868372502 0.41464722237401735461 0.45413112947326933488 0.49175377568020056662 0.52742785579951245722 0.56108774536529493204 0.59268895546259259266 0.62220717452337082065 0.64963693908006248101 0.67498998269859666888 0.69829331747725864599 0.71958710560147720603 0.73892237959533890734 0.75635866929433193118 0.77196159142664566577 0.78580045431799816491 0.79794592593244084711 0.80846780853356770002 0.81743295798410320341 0.82490338035181143272 0.83093453326769994849 0.83557385454940125147 0.83885953606476770794 0.84081955671952579578"
iteration_soln  = recursion_soln
fftw_soln = recursion_soln

recursion_seq = np.array([float(x) for x in recursion_seq.split(' ')])
recursion_par = np.array([float(x) for x in recursion_par.split(' ')])
recursion_task = np.array([float(x) for x in recursion_task.split(' ')])
iteration_seq = np.array([float(x) for x in iteration_seq.split(' ')])
iteration_par = np.array([float(x) for x in iteration_par.split(' ')])
fftw = np.array([float(x) for x in fftw.split(' ')])
print(recursion_task[-1])
print(iteration_par[-1])
print(fftw[-1])

recursion_soln = np.array([float(x.strip()) for x in recursion_soln.split(' ')])
iteration_soln = np.array([float(x) for x in iteration_soln.split(' ')])
fftw_soln = np.array([float(x) for x in fftw_soln.split(' ')])

fig = plt.figure()
ax = fig.add_subplot(111)
ax.loglog(N, recursion_seq, '*-', label = 'SEQ')
ax.loglog(N, recursion_par, '*-', label = 'PAR')
ax.loglog(N, recursion_task, '*-', label = 'TASK')
ax.set_title('Recursion: Forward+Inverse tramsform')
ax.set_xlabel('N')
ax.set_ylabel('Runtime')
ax.legend()
plt.savefig('recursion_fwd+inv.pdf')

fig = plt.figure()
ax = fig.add_subplot(111)
ax.loglog(N, iteration_seq, '*-', label = 'SEQ')
ax.loglog(N, iteration_par, '*-', label = 'PAR')
ax.set_title('Iteration: Forward+Inverse tramsform')
ax.set_xlabel('N')
ax.set_ylabel('Runtime')
ax.legend()
plt.savefig('iteration_fwd+inv.pdf')

fig = plt.figure()
ax = fig.add_subplot(111)
ax.loglog(N, recursion_task, '*-', label = 'Recursion')
ax.loglog(N, iteration_par, '*-', label = 'Iteration')
ax.loglog(N, fftw, '*-', label = 'FFTW')
ax.set_title('Comparison: Forward+Inverse tramsform')
ax.set_xlabel('N')
ax.set_ylabel('Runtime')
ax.legend()
plt.savefig('3in1_fwd+inv.pdf')


xs = np.linspace(0, 2*np.pi, 129)[:-1]
ext_soln = np.sin(np.cos(xs))
fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(xs, recursion_soln, '*-', label = 'Recursion')
ax.plot(xs, iteration_soln, '-', label = 'Iteration')
ax.plot(xs, fftw_soln, '-', label = 'FFTW')
ax.plot(xs, ext_soln, '-', label = 'Exact')
ax.set_title('Comparison: PDE solution')
ax.set_xlabel('x')
ax.set_ylabel('u')
ax.legend()
plt.savefig('PDE_soln.pdf')



plt.show()
